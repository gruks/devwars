---
phase: 03-game-engine
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/src/modules/questions/question.model.js
  - backend/src/modules/questions/question.routes.js
  backend/src/modules/questions/question.controller.js
  backend/src/routes.js
autonomous: true

must_haves:
  truths:
    - "Questions can be stored and retrieved from MongoDB"
    - "Questions have proper structure for debug battle mode"
    - "Admin can seed and manage questions"
    - "Debug questions contain buggy starter code and working solution"
  artifacts:
    - path: "backend/src/modules/questions/question.model.js"
      provides: "Question MongoDB schema"
      contains: "model Question"
    - path: "backend/src/modules/questions/question.routes.js"
      provides: "Question CRUD endpoints"
      exports: ["GET /api/v1/questions", "POST /api/v1/questions/seed"]
    - path: "backend/src/modules/questions/question.controller.js"
      provides: "Question business logic"
      exports: ["getQuestions", "seedQuestions", "getQuestionById"]
  key_links:
    - from: "backend/src/routes.js"
      to: "question.routes.js"
      via: "router.use('/questions')"
      pattern: "router\\.use\\('/questions'"
---

<objective>
Create Question model in MongoDB and question management API for debug battle mode.

Purpose: Foundation for storing questions with buggy starter code and solutions for the debug battle game mode.
Output: Working Question model with CRUD and seeding endpoints
</objective>

<execution_context>
@C:/Users/HP/.config/opencode/get-shit-done/workflows/execute-plan.md
@C:/Users/HP/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/03-game-engine/03-CONTEXT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@backend/src/modules/users/user.model.js
@backend/src/modules/rooms/room.model.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Question Model</name>
  <files>backend/src/modules/questions/question.model.js</files>
  <action>
Create Mongoose model for Question in backend/src/modules/questions/question.model.js:
- Schema fields: id (string), mode (debug), title, description, language (python/node/java/go/cpp), difficulty (easy/medium/hard/extreme), starterCode (buggy code), solution (working code), testcases (array of {input, output}), timeLimit (ms), memoryLimit (MB), isActive
- Add indexes: mode, difficulty, language
- Add pre-validate hook to generate id if not provided (uuid format: q-xxxxx)
- Export { Question }
  </action>
  <verify>File exists and exports Question model; contains all required fields per CONTEXT.md</verify>
  <done>Question model created with all fields: id, mode, title, description, language, difficulty, starterCode, solution, testcases[], timeLimit, memoryLimit</done>
</task>

<task type="auto">
  <name>Task 2: Create Question Controller</name>
  <files>backend/src/modules/questions/question.controller.js</files>
  <action>
Create question.controller.js with:
- getQuestions(query): Filter by mode=debug, difficulty, language. Support pagination (page, limit). Return {questions, total, page, pages}
- getQuestionById(id): Find by id, throw 404 if not found
- createQuestion(data): Validate required fields, create question
- seedQuestions(): Clear existing debug questions, insert 5 sample debug questions (1 easy, 2 medium, 2 hard). Each question should have buggy starterCode and correct solution with 3 testcases
- Use AppError for errors, HTTP_STATUS for status codes
- Follow service pattern used in auth.service.js
  </action>
  <verify>Controller exports getQuestions, getQuestionById, createQuestion, seedQuestions functions</verify>
  <done>Question controller handles CRUD and seeding with sample debug questions</done>
</task>

<task type="auto">
  <name>Task 3: Create Question Routes</name>
  <files>backend/src/modules/questions/question.routes.js, backend/src/routes.js</files>
  <action>
Create question.routes.js:
- GET / - getQuestions (supports ?mode=debug&difficulty=medium&language=python&page=1&limit=10)
- GET /:id - getQuestionById
- POST / - createQuestion (protected, admin only)
- POST /seed - seedQuestions (protected, admin only)

Then update backend/src/routes.js to add:
- router.use('/questions', require('./modules/questions/question.routes.js'));
  </action>
  <verify>Routes created and registered; GET /api/v1/questions returns questions list</verify>
  <done>Question routes registered at /api/v1/questions with CRUD and seeding</done>
</task>

</tasks>

<verification>
- Question model created with all required fields
- Routes registered and responding
- Seed endpoint creates 5 debug questions
</verification>

<success_criteria>
Questions can be stored, retrieved, and seeded via API
</success_criteria>

<output>
After completion, create `.planning/phases/03-game-engine/03-01-SUMMARY.md`
</output>
